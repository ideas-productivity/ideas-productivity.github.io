<!-- 

UPCOMING EVENTS

-------------------------------------------------------------------------------

available parameters:
* title
* group-linktext
* group-linkurl
limit (default: 3)

* required

-------------------------------------------------------------------------------

-->

{% assign limit = include.limit | default: 3 %}

<div class="upcoming-events">


	<!-- Group Intro  -->
	<div class="group-intro">
			<h1>{{ include.title }}</h1>

			<a class="group-link" href="{{ include.group-linkurl }}">
				{{ include.group-linktext }}
			</a>	

			<hr>
	</div>	


	<!-- Event Listing  -->
	{% assign today = site.time | date:"%Y-%m-%d" %}
	{% assign sorted = site.events | where_exp: "item", "item.startdate >= today or item.enddate >= today" | sort:"startdate"  %}

		{% if sorted and sorted.size != 0 %}
		<ul class="event-list">
		{% for event in sorted limit: limit %}
			<li>

			{% comment %}
				For most events, we take the title as-is from the frontmatter.  But tutorials are special.  
				They usually have a "title-type" that characterizes how the venue labels the event (e.g., tutorial or track or training or...).
				They also have venue information, which we will add to the title iff this is a standalone event (i.e., one that doesn't have
				parent-event information).
			{% endcomment %}

			{% if event.title-type %}
				{% assign my-title = event.title | append: " " | append: event.title-type %}
			{% else %}
				{% assign my-title = event.title %}
			{% endif %}

			{% unless event.parent-event-name and event.parent-event-file %}
				{% if event.venue %}
				  {% assign my-title = my-title | append: " @ " | append: event.venue %}
				{% endif %}
			{% endunless %}	
				<a href="{{ event.url }}" class="event-link">
				  <h2 class="event-title">{{ my-title }}</h2>
				  <p class="event-date">
				  	{{ event.startdate | date:"%b %d" }}
					  {% assign startmo = event.startdate | date:"%b"  %}
					  {% assign endmo = event.enddate | date:"%b"  %}
					  {% if event.enddate %}
					  	{% if startmo == endmo %}
					  		â€“{{ event.enddate | date:"%d" }}
					  	{% else %}
					  		â€“{{ event.enddate | date:"%b %d" }}
					  	{% endif %}
					  {% endif %}
					</p>
					<small class="event-year">{{ event.startdate | date:"%Y" }}</small>
					<small class="event-type">{{ event.type }}</small>
				</a>
				{% if event.series %}
			  		<small class="event-series">Series: {{ event.series }}</small> 
				{% endif %}
			</li>
		{% endfor %}
	</ul>
	{% else %}
	<p>No events found</p>
	{% endif %}
	{% assign remaining = sorted | size | minus: limit %}
	{% if remaining > 0 %}
		<p class="upcoming-events--more"><a href='{{ include.group-linkurl }}'>see {{remaining }} more upcoming {{ remaining | pluralize: "event", "events" }}</a></p>
	{% endif %}

</div>