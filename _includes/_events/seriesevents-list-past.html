<div class="list-events">

	<!-- Paginated Event Listing
	adapted from: https://blog.rafael.picanco.nom.br/2015/09/06/jekyll-pagination-on-github-pages-without-plugins.html 
	-->

	<!-- Query the events -->
	{% assign series = include.series %}
	{% assign today = site.time | date:"%Y-%m-%d" %}
	{% assign enddate = site.events | where_exp: "item", "item.startdate < today and item.enddate < today" %}
	{% assign noenddate = site.events | where_exp: "item", "item.enddate == nil and item.startdate < today" %}
	{% assign sorted = enddate | concat: noenddate | where_exp: "item", "item.series contains series" | sort:"startdate" | reverse %}

	<!-- List Markup -->
	<div class="eventlist-wrapper" id="js-upcoming-events">

		{% if include.title %}
			<div class="list-title">
				<h1 class="list-title">{{ include.title }}</h1>

				{% if include.group-linktext %}
				<a class="group-link" href="{{ include.group-linkurl }}">
					{{ include.group-linktext }}
				</a>
				{% endif %}
				<hr>
			</div>
		{% endif %}

		{% if sorted and sorted.size != 0 %}
		<ul class="list">
			{% for event in sorted %}
			{% if event.link-id %}
			<li id="{{ event.link-id }}">
			{% else %}
			<li>	
			{% endif %}

			{% comment %}
				For most events, we take the title as-is from the frontmatter.  But tutorials are special.  
				They usually have a "title-type" that characterizes how the venue labels the event (e.g., tutorial or track or training or...).
				They also have venue information, which we will add to the title iff this is a standalone event (i.e., one that doesn't have
				parent-event information).
			{% endcomment %}

			{% if event.title-type %}
				{% assign my-title = event.title | append: " " | append: event.title-type %}
			{% else %}
				{% assign my-title = event.title %}
			{% endif %}

				{% if event.venue %}
				  {% assign my-title = my-title | append: " @ " | append: event.venue %}
				{% endif %}
					<a href="{{ event.url }}" class="event-link">
					  <h2 class="event-title">{{ my-title }}</h2>
					  <p class="event-date">
					  	{{ event.startdate | date:"%b %d" }}
						  {% assign startmo = event.startdate | date:"%b"  %}
						  {% assign endmo = event.enddate | date:"%b"  %}
						  {% if event.enddate %}
						  	{% if startmo == endmo %}
						  		–{{ event.enddate | date:"%d" }}
						  	{% else %}
						  		–{{ event.enddate | date:"%b %d" }}
						  	{% endif %}
						  {% endif %}
						</p>
						<small class="event-year">{{ event.startdate | date:"%Y" }}</small>
						<small class="event-type">{{ event.type }}</small>
					</a>
				  {% if event.series %}
							{% assign length = event.series | size %}
					  	<small class="event-series">Series: 
							{{ event.series | join: ", " }}
					  	</small> 
					  {% endif %}
				</li>
			{% endfor %}
		</ul>
		{% else %}
		<p>No events found</p>
		{% endif %}

		<div class="pagination-wrapper">
			<ul id="js-pagination" class="pagination"></ul>
		</div>

	</div>



</div>