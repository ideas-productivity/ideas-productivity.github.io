<div class="list-events">

	<!-- Paginated Event Listing
	adapted from: https://blog.rafael.picanco.nom.br/2015/09/06/jekyll-pagination-on-github-pages-without-plugins.html 
	-->

	<!-- Query the events -->
	{% assign today = site.time | date:"%Y-%m-%d" %}
	{% assign sorted = site.events | where_exp: "item", "item.startdate >= today" | sort:"startdate"  %}


	<!-- List Markup -->
	<div class="eventlist-wrapper" id="js-upcoming-events">

		{% if include.title %}
			<div class="list-title">
				<h1 class="list-title">{{ include.title }}</h1>
				<hr>
			</div>
		{% endif %}

		<ul class="list">
			{% for event in sorted %}
				{% unless event.subevent %}
		  		<li>	
						<a href="{{ event.url }}" class="event-link">
						  <h2 class="event-title">{{ event.title }}</h2>
						  <p class="event-date">
						  	{{ event.startdate | date:"%b %d" }}
							  {% assign startmo = event.startdate | date:"%b"  %}
							  {% assign endmo = event.enddate | date:"%b"  %}
							  {% if event.enddate %}
							  	{% if startmo == endmo %}
							  		â€“{{ event.enddate | date:"%d" }}
							  	{% else %}
							  		â€“{{ event.enddate | date:"%b %d" }}
							  	{% endif %}
							  {% endif %}
							</p>
							<small class="event-year">
								{{ event.startdate | date:"%Y" }}
							</small>
							<small class="event-type">
								{{ event.type }}
							</small>
						</a>
						{% if event.series %}
							{% assign length = event.series | size %}
					  	<small class="event-series">Series: 
					  		{% if length > 1 %}
						  		{% for item in event.series %}
						  			{% if forloop.index < length %}
						  				{{ item }}, 
						  			{% else %}
						  				{{ item }}
						  			{% endif %}	
						  		{% endfor %}
						  	{% else %}
						  		{{ event.series[0] }}
						  	{% endif %}
					  	</small> 
					  {% endif %}


					  {% if event.subevents %}
					  	<ul class="subevents">
						  	{% for subslug in event.subevents %}
						  	{% assign sub = site.events | where: 'slug', subslug %}
						  		<li>
						  			<a href="{{ sub[0].url }}" class="subevent-link">
						  				<h3 class="subevent-title">
							  				{{ sub[0].title }}
							  			</h3>
							  			<p class="subevent-time">
							  				{{ sub[0].time }}
							  			</p>
							  			<small class="subevent-date">
							  				{{ sub[0].startdate | date:"%b %d" }}
							  			</small>
							  			<small class="subevent-type">
							  				{{ sub[0].type }}
							  			</small>
							  		</a>
							  			{% if sub[0].series %}
												{% assign sublength = sub[0].series | size %}
										  	<small class="subevent-series">Series: 
										  		{% if sublength > 1 %}
											  		{% for item in sub[0].series %}
											  			{% if forloop.index < sublength %}
											  				{{ item }}, 
											  			{% else %}
											  				{{ item }}
											  			{% endif %}	
											  		{% endfor %}
											  	{% else %}
											  		{{ sub[0].series[0] }}
											  	{% endif %}
										  	</small> 
										  {% endif %}
							  	</li>
						  	{% endfor %}
						  </ul>
					  {% endif %}
					</li>
				{% endunless %}
			{% endfor %}
		</ul>

		<div class="pagination-wrapper">
			<ul id="js-pagination" class="pagination"></ul>
		</div>

	</div>



</div>